<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ø¨ÙˆØª Ø§Ù„Ù‡ÙŠØ¦Ø© Ø§Ù„Ø®ÙŠØ±ÙŠØ© - Ø¥Ø¬Ø§Ø¨Ø§Øª Ù…Ù† JSON</title>
  <style>
    body { font-family: Arial; max-width: 700px; margin: auto; padding: 20px; background-color: #f4f4f4; }
    input, textarea, button { width: 100%; padding: 10px; margin: 10px 0; }
    #output { background: #fff; padding: 15px; border-radius: 8px; white-space: pre-wrap; direction: rtl; }
  </style>
</head>
<body>
  <h2>ğŸ§  Ø¨ÙˆØª Ø§Ù„Ù‡ÙŠØ¦Ø© Ø§Ù„Ø®ÙŠØ±ÙŠØ© - ÙŠØ¬ÙŠØ¨ ÙÙ‚Ø· Ù…Ù† Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©</h2>

  <label>â“Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ Ù‡Ù†Ø§:</label>
  <input type="text" id="question" placeholder="Ù…Ø«Ø§Ù„: Ù…Ù† Ù‡Ùˆ Ø±Ø¦ÙŠØ³ Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©ØŸ">
  <button onclick="askFromJson()">ğŸ” Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø³Ø¤Ø§Ù„</button>

  <h3>ğŸ“‘ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©:</h3>
  <div id="output">ğŸ•“ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø¨Ø¹Ø¯...</div>

  <script>
    const apiKey = "AIzaSyDhKb8ORRxUvIBDNLPuTuwhKqE_N52bOts";
    let fullText = "";

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†ØµÙˆØµ Ù…Ù† Ù…Ù„Ù JSON
    fetch("iico_pages.json")
      .then(res => res.json())
      .then(data => {
        fullText = data.map(p => `\n[${p.title}]\n${p.content}`).join("\n\n");
      })
      .catch(err => {
        document.getElementById("output").innerText = "âš ï¸ ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†ØµÙˆØµ";
      });

    async function askFromJson() {
      const question = document.getElementById("question").value;
      if (!fullText) {
        document.getElementById("output").innerText = "âš ï¸ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù†Øµ Ù…ØªØ§Ø­ Ù„Ù„Ø¥Ø¬Ø§Ø¨Ø©.";
        return;
      }

      const prompt = `Ø£Ø¬Ø¨ Ø¹Ù„Ù‰ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù†Øµ ÙÙ‚Ø·. Ù„Ø§ ØªØ¶Ù Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù…Ù† Ø®Ø§Ø±Ø¬ Ø§Ù„Ù†Øµ. Ø¥Ø°Ø§ Ù„Ù… ØªØ¬Ø¯ Ø¥Ø¬Ø§Ø¨Ø© ØµØ±ÙŠØ­Ø©ØŒ Ù‚Ù„: \"Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©\".\n\nØ§Ù„Ù†Øµ:\n${fullText}\n\nØ§Ù„Ø³Ø¤Ø§Ù„: ${question}`;

      document.getElementById("output").innerText = "â³ Ø¬Ø§Ø±ÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø¥Ù„Ù‰ Gemini...";

      try {
        const response = await fetch("https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=" + apiKey, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            contents: [{ parts: [{ text: prompt }] }],
            generationConfig: { temperature: 0.4, topK: 1, topP: 1, maxOutputTokens: 1024 }
          })
        });

        const result = await response.json();
        const answer = result.candidates?.[0]?.content?.parts?.[0]?.text || "Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¥Ø¬Ø§Ø¨Ø©.";
        document.getElementById("output").innerText = answer;
      } catch (err) {
        document.getElementById("output").innerText = "âš ï¸ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ Gemini API";
      }
    }
  </script>
</body>
</html>
